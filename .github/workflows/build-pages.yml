# .github/workflows/build-pages.yml
name: Docs Hub → GitHub Pages

on:
  # trigger manually or on any push you want
  workflow_dispatch:

permissions:
  contents: read
  pages: write          # needed by deploy-pages
  id-token: write       # needed by deploy-pages
  actions: read         # lets deploy-pages read the build’s artifacts

###############################################################################
jobs:
  # ─────────────────────────────────────────────────────────────────── BUILD ──
  build:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v4

      # 0️⃣  Tell GitHub “this run will publish a Pages artifact”
      - name: Setup Pages
        id: pages
        uses: actions/configure-pages@v3     # <- v3 is current

      #########################################################################
      # 👉 PUT *YOUR* BUILD LOGIC HERE
      #    For the smoke-test we just echo a file; replace these 3 lines
      #########################################################################
      - name: Build site
        run: |
          rm -rf site && mkdir -p site
          echo '<h1>Hello Pages</h1>' > site/index.html
      #########################################################################

      # 1️⃣  Upload the folder; must keep default artifact name **github-pages**
      - name: Upload Pages artifact
        uses: actions/upload-pages-artifact@v1  # <-- v1 (not v2) is the combo
        with:
          path: site                            # folder to publish

  # ───────────────────────────────────────────────────────────────── DEPLOY ──
  deploy:
    needs: build
    runs-on: ubuntu-latest

    environment:            # GitHub creates ‘github-pages’ on first success
      name: github-pages
      url:  ${{ steps.deployment.outputs.page_url }}

    permissions:
      pages: write
      id-token: write
      actions: read          # keep

    steps:
      - name: Deploy to GitHub Pages
        id: deployment
        uses: actions/deploy-pages@v2         # <- v2 is current
